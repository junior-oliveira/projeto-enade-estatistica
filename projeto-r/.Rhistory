percentil_75 = round(percentis[2],1)
# normalidade
teste_normalidade = 1#ad.test(dados)
p_value <- signif(1, 3)
normalidade = "Sim"
if(p_value < 0.05){
normalidade = "Não"
}
# Traduz o código da variável para o valor correspondente (carregar source("conf.R") antes)
valor_traduzido <- DF_VAR_VALOR_NOME[DF_VAR_VALOR_NOME[, "VARIAVEL"]==variavel & DF_VAR_VALOR_NOME[,"VALOR"]==valor,"NOME"]
descricao <- DF_VAR_VALOR_NOME[DF_VAR_VALOR_NOME[, "VARIAVEL"]==variavel & DF_VAR_VALOR_NOME[,"VALOR"]==valor,"DESCRICAO"]
linha <- c(descricao, valor_traduzido, n, media, desvio_padrao, mediana, minimo, maximo, percentil_25, percentil_75, p_value, normalidade)
return(linha)
}
est_desc <- tabela_estatisticas(microdados_enade, LIST_VAR_INTERESSE)
estatisticas_descritivas <- function(dados_enade, variavel, valor){
# Filtra os dados que serão considerados no cálculo das estatísticas
dados <- filtrar_por_variaveis(dados_enade, c(variavel), c(valor))
dados <- dados$PROVA_NOTABRUTA
n <- length(dados)
media <- round(mean(dados), 1)
desvio_padrao <- round(sd(dados), 1)
mediana <- round(median(dados),1)
minimo <- round(min(dados),1)
maximo <- round(max(dados),1)
percentis <- quantile(dados, c(0.25, 0.75))
# remove os nomes associados às variáveis
percentis <- unname(percentis)
percentil_25 = round(percentis[1],1)
percentil_75 = round(percentis[2],1)
# normalidade
teste_normalidade = ad.test(dados)
p_value <- signif(teste_normalidade$p.value, 3)
normalidade = "Sim"
if(p_value < 0.05){
normalidade = "Não"
}
source("conf.R")
est_desc <- tabela_estatisticas(microdados_enade, LIST_VAR_INTERESSE)
estatisticas_descritivas <- function(dados_enade, variavel, valor){
# Filtra os dados que serão considerados no cálculo das estatísticas
dados <- filtrar_por_variaveis(dados_enade, c(variavel), c(valor))
dados <- dados$PROVA_NOTABRUTA
n <- length(dados)
media <- round(mean(dados), 1)
desvio_padrao <- round(sd(dados), 1)
mediana <- round(median(dados),1)
minimo <- round(min(dados),1)
maximo <- round(max(dados),1)
percentis <- quantile(dados, c(0.25, 0.75))
# remove os nomes associados às variáveis
percentis <- unname(percentis)
percentil_25 = round(percentis[1],1)
percentil_75 = round(percentis[2],1)
# normalidade
teste_normalidade = ad.test(dados)
p_value <- signif(teste_normalidade$p.value, 3)
normalidade = "Sim"
if(p_value < 0.05){
normalidade = "Não"
}
# Traduz o código da variável para o valor correspondente (carregar source("conf.R") antes)
valor_traduzido <- DF_VAR_VALOR_NOME[DF_VAR_VALOR_NOME[, "VARIAVEL"]==variavel & DF_VAR_VALOR_NOME[,"VALOR"]==valor,"NOME"]
descricao <- DF_VAR_VALOR_NOME[DF_VAR_VALOR_NOME[, "VARIAVEL"]==variavel & DF_VAR_VALOR_NOME[,"VALOR"]==valor,"DESCRICAO"]
linha <- c(descricao, valor_traduzido, n, media, desvio_padrao, mediana, minimo, maximo, percentil_25, percentil_75, p_value, normalidade)
return(linha)
}
est_desc <- tabela_estatisticas(microdados_enade, LIST_VAR_INTERESSE)
source("conf.R")
est_desc <- tabela_estatisticas(microdados_enade, LIST_VAR_INTERESSE)
View(est_desc)
View(microdados_enade)
source("conf.R")
est_desc <- tabela_estatisticas(microdados_enade, LIST_VAR_INTERESSE)
estatisticas_descritivas <- function(dados_enade, variavel, valor){
# Filtra os dados que serão considerados no cálculo das estatísticas
dados <- filtrar_por_variaveis(dados_enade, c(variavel), c(valor))
dados <- dados$PROVA_NOTABRUTA
print(length(dados))
n <- length(dados)
media <- round(mean(dados), 1)
desvio_padrao <- round(sd(dados), 1)
mediana <- round(median(dados),1)
minimo <- round(min(dados),1)
maximo <- round(max(dados),1)
percentis <- quantile(dados, c(0.25, 0.75))
# remove os nomes associados às variáveis
percentis <- unname(percentis)
percentil_25 = round(percentis[1],1)
percentil_75 = round(percentis[2],1)
# normalidade
teste_normalidade = ad.test(dados)
p_value <- signif(teste_normalidade$p.value, 3)
normalidade = "Sim"
if(p_value < 0.05){
normalidade = "Não"
}
# Traduz o código da variável para o valor correspondente (carregar source("conf.R") antes)
valor_traduzido <- DF_VAR_VALOR_NOME[DF_VAR_VALOR_NOME[, "VARIAVEL"]==variavel & DF_VAR_VALOR_NOME[,"VALOR"]==valor,"NOME"]
descricao <- DF_VAR_VALOR_NOME[DF_VAR_VALOR_NOME[, "VARIAVEL"]==variavel & DF_VAR_VALOR_NOME[,"VALOR"]==valor,"DESCRICAO"]
linha <- c(descricao, valor_traduzido, n, media, desvio_padrao, mediana, minimo, maximo, percentil_25, percentil_75, p_value, normalidade)
return(linha)
}
est_desc <- tabela_estatisticas(microdados_enade, LIST_VAR_INTERESSE)
x
estatisticas_descritivas <- function(dados_enade, variavel, valor){
# Filtra os dados que serão considerados no cálculo das estatísticas
dados <- filtrar_por_variaveis(dados_enade, c(variavel), c(valor))
dados <- dados$PROVA_NOTABRUTA
print(variavel)
print(valor)
print(length(dados))
n <- length(dados)
media <- round(mean(dados), 1)
desvio_padrao <- round(sd(dados), 1)
mediana <- round(median(dados),1)
minimo <- round(min(dados),1)
maximo <- round(max(dados),1)
percentis <- quantile(dados, c(0.25, 0.75))
# remove os nomes associados às variáveis
percentis <- unname(percentis)
percentil_25 = round(percentis[1],1)
percentil_75 = round(percentis[2],1)
# normalidade
teste_normalidade = ad.test(dados)
p_value <- signif(teste_normalidade$p.value, 3)
normalidade = "Sim"
if(p_value < 0.05){
normalidade = "Não"
}
# Traduz o código da variável para o valor correspondente (carregar source("conf.R") antes)
valor_traduzido <- DF_VAR_VALOR_NOME[DF_VAR_VALOR_NOME[, "VARIAVEL"]==variavel & DF_VAR_VALOR_NOME[,"VALOR"]==valor,"NOME"]
descricao <- DF_VAR_VALOR_NOME[DF_VAR_VALOR_NOME[, "VARIAVEL"]==variavel & DF_VAR_VALOR_NOME[,"VALOR"]==valor,"DESCRICAO"]
linha <- c(descricao, valor_traduzido, n, media, desvio_padrao, mediana, minimo, maximo, percentil_25, percentil_75, p_value, normalidade)
return(linha)
}
est_desc <- tabela_estatisticas(microdados_enade, LIST_VAR_INTERESSE)
source("conf.R")
est_desc <- tabela_estatisticas(microdados_enade, LIST_VAR_INTERESSE)
View(est_desc)
estatisticas_descritivas <- function(dados_enade, variavel, valor){
# Filtra os dados que serão considerados no cálculo das estatísticas
dados <- filtrar_por_variaveis(dados_enade, c(variavel), c(valor))
dados <- dados$PROVA_NOTABRUTA
n <- length(dados)
media <- round(mean(dados), 1)
desvio_padrao <- round(sd(dados), 1)
mediana <- round(median(dados),1)
minimo <- round(min(dados),1)
maximo <- round(max(dados),1)
percentis <- quantile(dados, c(0.25, 0.75))
# remove os nomes associados às variáveis
percentis <- unname(percentis)
percentil_25 = round(percentis[1],1)
percentil_75 = round(percentis[2],1)
# normalidade
teste_normalidade = ad.test(dados)
p_value <- signif(teste_normalidade$p.value, 3)
normalidade = "Sim"
if(p_value < 0.05){
normalidade = "Não"
}
# Traduz o código da variável para o valor correspondente (carregar source("conf.R") antes)
valor_traduzido <- DF_VAR_VALOR_NOME[DF_VAR_VALOR_NOME[, "VARIAVEL"]==variavel & DF_VAR_VALOR_NOME[,"VALOR"]==valor,"NOME"]
descricao <- DF_VAR_VALOR_NOME[DF_VAR_VALOR_NOME[, "VARIAVEL"]==variavel & DF_VAR_VALOR_NOME[,"VALOR"]==valor,"DESCRICAO"]
linha <- c(descricao, valor_traduzido, n, media, desvio_padrao, mediana, minimo, maximo, percentil_25, percentil_75, p_value, normalidade)
return(linha)
}
est_desc <- tabela_estatisticas(microdados_enade, LIST_VAR_INTERESSE)
View(est_desc)
estatisticas_descritivas <- function(dados_enade, variavel, valor, filtrar=TRUE){
# Filtra os dados que serão considerados no cálculo das estatísticas
if(filtrar){
dados <- filtrar_por_variaveis(dados_enade, c(variavel), c(valor))
}
dados <- dados$PROVA_NOTABRUTA
n <- length(dados)
media <- round(mean(dados), 1)
desvio_padrao <- round(sd(dados), 1)
mediana <- round(median(dados),1)
minimo <- round(min(dados),1)
maximo <- round(max(dados),1)
percentis <- quantile(dados, c(0.25, 0.75))
# remove os nomes associados às variáveis
percentis <- unname(percentis)
percentil_25 = round(percentis[1],1)
percentil_75 = round(percentis[2],1)
# normalidade
teste_normalidade = ad.test(dados)
p_value <- signif(teste_normalidade$p.value, 3)
normalidade = "Sim"
if(p_value < 0.05){
normalidade = "Não"
}
# Traduz o código da variável para o valor correspondente (carregar source("conf.R") antes)
if(filtrar){
valor_traduzido <- DF_VAR_VALOR_NOME[DF_VAR_VALOR_NOME[, "VARIAVEL"]==variavel & DF_VAR_VALOR_NOME[,"VALOR"]==valor,"NOME"]
descricao <- DF_VAR_VALOR_NOME[DF_VAR_VALOR_NOME[, "VARIAVEL"]==variavel & DF_VAR_VALOR_NOME[,"VALOR"]==valor,"DESCRICAO"]
}
else{
descricao <- variavel
valor_traduzido <- valor
}
linha <- c(descricao, valor_traduzido, n, media, desvio_padrao, mediana, minimo, maximo, percentil_25, percentil_75, p_value, normalidade)
return(linha)
}
est_desc <- tabela_estatisticas(microdados_enade, LIST_VAR_INTERESSE)
View(est_desc)
tabela_estatisticas <- function(dados_enade, variaveis_interesse){
colunas <- c('Variável', 'Valor', 'n', 'media', 'desvio_padrao', 'mediana', 'minimo', 'maximo', 'percentil_25', 'percentil_50', 'p-valor', 'normalidade')
df <- setNames(data.frame(matrix(ncol = length(colunas), nrow = 0)), colunas)
linha <- estatisticas_descritivas(dados_enade, "Geral", '-', filtrar = FALSE)
df[nrow(df) + 1, ] <- linha
for(var_interesse in variaveis_interesse){
valores = DF_VAR_VALOR_NOME[DF_VAR_VALOR_NOME[, "VARIAVEL"] == var_interesse,"VALOR"]
for(valor in valores){
linha <- estatisticas_descritivas(dados_enade, var_interesse, valor)
df[nrow(df) + 1, ] <- linha
}
}
return(df)
}
est_desc <- tabela_estatisticas(microdados_enade, LIST_VAR_INTERESSE)
estatisticas_descritivas <- function(dados_enade, variavel, valor, filtrar=TRUE){
# Filtra os dados que serão considerados no cálculo das estatísticas
if(filtrar){
dados <- filtrar_por_variaveis(dados_enade, c(variavel), c(valor))
}
else{
dados <- dados_enade$PROVA_NOTABRUTA
}
dados <- dados$PROVA_NOTABRUTA
n <- length(dados)
media <- round(mean(dados), 1)
desvio_padrao <- round(sd(dados), 1)
mediana <- round(median(dados),1)
minimo <- round(min(dados),1)
maximo <- round(max(dados),1)
percentis <- quantile(dados, c(0.25, 0.75))
# remove os nomes associados às variáveis
percentis <- unname(percentis)
percentil_25 = round(percentis[1],1)
percentil_75 = round(percentis[2],1)
# normalidade
teste_normalidade = ad.test(dados)
p_value <- signif(teste_normalidade$p.value, 3)
normalidade = "Sim"
if(p_value < 0.05){
normalidade = "Não"
}
# Traduz o código da variável para o valor correspondente (carregar source("conf.R") antes)
if(filtrar){
valor_traduzido <- DF_VAR_VALOR_NOME[DF_VAR_VALOR_NOME[, "VARIAVEL"]==variavel & DF_VAR_VALOR_NOME[,"VALOR"]==valor,"NOME"]
descricao <- DF_VAR_VALOR_NOME[DF_VAR_VALOR_NOME[, "VARIAVEL"]==variavel & DF_VAR_VALOR_NOME[,"VALOR"]==valor,"DESCRICAO"]
}
else{
descricao <- variavel
valor_traduzido <- valor
}
linha <- c(descricao, valor_traduzido, n, media, desvio_padrao, mediana, minimo, maximo, percentil_25, percentil_75, p_value, normalidade)
return(linha)
}
est_desc <- tabela_estatisticas(microdados_enade, LIST_VAR_INTERESSE)
estatisticas_descritivas <- function(dados_enade, variavel, valor, filtrar=TRUE){
# Filtra os dados que serão considerados no cálculo das estatísticas
if(filtrar){
dados <- filtrar_por_variaveis(dados_enade, c(variavel), c(valor))
dados <- dados$PROVA_NOTABRUTA
}
else{
dados <- dados_enade$PROVA_NOTABRUTA
}
n <- length(dados)
media <- round(mean(dados), 1)
desvio_padrao <- round(sd(dados), 1)
mediana <- round(median(dados),1)
minimo <- round(min(dados),1)
maximo <- round(max(dados),1)
percentis <- quantile(dados, c(0.25, 0.75))
# remove os nomes associados às variáveis
percentis <- unname(percentis)
percentil_25 = round(percentis[1],1)
percentil_75 = round(percentis[2],1)
# normalidade
teste_normalidade = ad.test(dados)
p_value <- signif(teste_normalidade$p.value, 3)
normalidade = "Sim"
if(p_value < 0.05){
normalidade = "Não"
}
# Traduz o código da variável para o valor correspondente (carregar source("conf.R") antes)
if(filtrar){
valor_traduzido <- DF_VAR_VALOR_NOME[DF_VAR_VALOR_NOME[, "VARIAVEL"]==variavel & DF_VAR_VALOR_NOME[,"VALOR"]==valor,"NOME"]
descricao <- DF_VAR_VALOR_NOME[DF_VAR_VALOR_NOME[, "VARIAVEL"]==variavel & DF_VAR_VALOR_NOME[,"VALOR"]==valor,"DESCRICAO"]
}
else{
descricao <- variavel
valor_traduzido <- valor
}
linha <- c(descricao, valor_traduzido, n, media, desvio_padrao, mediana, minimo, maximo, percentil_25, percentil_75, p_value, normalidade)
return(linha)
}
est_desc <- tabela_estatisticas(microdados_enade, LIST_VAR_INTERESSE)
View(est_desc)
tabela_estatisticas <- function(dados_enade, variaveis_interesse){
colunas <- c('Variável', 'Valor', 'n', 'media', 'desvio_padrao', 'mediana', 'minimo', 'maximo', 'percentil_25', 'percentil_50', 'p-valor', 'normalidade')
df <- setNames(data.frame(matrix(ncol = length(colunas), nrow = 0)), colunas)
linha <- estatisticas_descritivas(dados_enade, "Total", '', filtrar = FALSE)
df[nrow(df) + 1, ] <- linha
for(var_interesse in variaveis_interesse){
valores = DF_VAR_VALOR_NOME[DF_VAR_VALOR_NOME[, "VARIAVEL"] == var_interesse,"VALOR"]
for(valor in valores){
linha <- estatisticas_descritivas(dados_enade, var_interesse, valor)
df[nrow(df) + 1, ] <- linha
}
}
return(df)
}
est_desc <- tabela_estatisticas(microdados_enade, LIST_VAR_INTERESSE)
View(est_desc)
View(est_desc)
View(est_desc)
write_xlsx(est_desc, "tabelas/analise_descritiva_e_normalidade.xlsx")
View(est_desc)
library(xtable)
library(xtable)
<<results=tex>>
xtable(est_desc)
@
xtable(est_desc)
View(est_desc)
est_desc <- tabela_estatisticas(microdados_enade, LIST_VAR_INTERESSE)
estatisticas_descritivas <- function(dados_enade, variavel, valor, filtrar=TRUE){
# Filtra os dados que serão considerados no cálculo das estatísticas
if(filtrar){
dados <- filtrar_por_variaveis(dados_enade, c(variavel), c(valor))
dados <- dados$PROVA_NOTABRUTA
}
else{
dados <- dados_enade$PROVA_NOTABRUTA
}
n <- length(dados)
media <- round(mean(dados), 1)
desvio_padrao <- round(sd(dados), 1)
mediana <- round(median(dados),1)
minimo <- round(min(dados),1)
maximo <- round(max(dados),1)
percentis <- quantile(dados, c(0.25, 0.75))
# remove os nomes associados às variáveis
percentis <- unname(percentis)
percentil_25 = round(percentis[1],1)
percentil_75 = round(percentis[2],1)
# normalidade
teste_normalidade = ad.test(dados)
p_value <- signif(teste_normalidade$p.value, 3)
normalidade = "Sim"
if(p_value < 0.05){
normalidade = "Não"
}
# Traduz o código da variável para o valor correspondente (carregar source("conf.R") antes)
if(filtrar){
valor_traduzido <- DF_VAR_VALOR_NOME[DF_VAR_VALOR_NOME[, "VARIAVEL"]==variavel & DF_VAR_VALOR_NOME[,"VALOR"]==valor,"NOME"]
descricao <- DF_VAR_VALOR_NOME[DF_VAR_VALOR_NOME[, "VARIAVEL"]==variavel & DF_VAR_VALOR_NOME[,"VALOR"]==valor,"DESCRICAO"]
}
else{
descricao <- variavel
valor_traduzido <- valor
}
linha <- c(descricao, valor_traduzido, n, media, desvio_padrao, mediana, minimo, p_value, normalidade)
return(linha)
}
# Função de retorna a tabela com todas as estatísticas descritivas de cada variável considerada
tabela_estatisticas <- function(dados_enade, variaveis_interesse){
# Utilizar se considerar os percentis
#colunas <- c('Variável', 'Valor', 'n', 'media', 'desvio_padrao', 'mediana', 'minimo', 'maximo', 'percentil_25', 'percentil_50', 'p-valor', 'normalidade')
colunas <- c('Variável', 'Valor', 'n', 'Med', 'DP', 'Medi', 'Min', 'Max', 'p-valor', 'Norm')
df <- setNames(data.frame(matrix(ncol = length(colunas), nrow = 0)), colunas)
linha <- estatisticas_descritivas(dados_enade, "Total", '', filtrar = FALSE)
df[nrow(df) + 1, ] <- linha
for(var_interesse in variaveis_interesse){
valores = DF_VAR_VALOR_NOME[DF_VAR_VALOR_NOME[, "VARIAVEL"] == var_interesse,"VALOR"]
for(valor in valores){
linha <- estatisticas_descritivas(dados_enade, var_interesse, valor)
df[nrow(df) + 1, ] <- linha
}
}
return(df)
}
est_desc <- tabela_estatisticas(microdados_enade, LIST_VAR_INTERESSE)
estatisticas_descritivas <- function(dados_enade, variavel, valor, filtrar=TRUE){
# Filtra os dados que serão considerados no cálculo das estatísticas
if(filtrar){
dados <- filtrar_por_variaveis(dados_enade, c(variavel), c(valor))
dados <- dados$PROVA_NOTABRUTA
}
else{
dados <- dados_enade$PROVA_NOTABRUTA
}
n <- length(dados)
media <- round(mean(dados), 1)
desvio_padrao <- round(sd(dados), 1)
mediana <- round(median(dados),1)
minimo <- round(min(dados),1)
maximo <- round(max(dados),1)
percentis <- quantile(dados, c(0.25, 0.75))
# remove os nomes associados às variáveis
percentis <- unname(percentis)
percentil_25 = round(percentis[1],1)
percentil_75 = round(percentis[2],1)
# normalidade
teste_normalidade = ad.test(dados)
p_value <- signif(teste_normalidade$p.value, 3)
normalidade = "Sim"
if(p_value < 0.05){
normalidade = "Não"
}
# Traduz o código da variável para o valor correspondente (carregar source("conf.R") antes)
if(filtrar){
valor_traduzido <- DF_VAR_VALOR_NOME[DF_VAR_VALOR_NOME[, "VARIAVEL"]==variavel & DF_VAR_VALOR_NOME[,"VALOR"]==valor,"NOME"]
descricao <- DF_VAR_VALOR_NOME[DF_VAR_VALOR_NOME[, "VARIAVEL"]==variavel & DF_VAR_VALOR_NOME[,"VALOR"]==valor,"DESCRICAO"]
}
else{
descricao <- variavel
valor_traduzido <- valor
}
linha <- c(descricao, valor_traduzido, n, media, desvio_padrao, mediana, minimo, maximo, p_value, normalidade)
return(linha)
}
est_desc <- tabela_estatisticas(microdados_enade, LIST_VAR_INTERESSE)
xtable(est_desc)
vars <- c(var1 = 'Variável', 'Valor', 'n', 'Med', 'DP', 'Medi', 'Min', 'Max', 'p-valor', 'Norm' )
select(est_desc, !!vars)
t = select(est_desc, !!vars)
View(t)
vars <- c('Variável', 'Valor', 'n', 'Med', 'DP', 'Medi', 'Min', 'Max', 'p-valor', 'Norm' )
t = select(est_desc, !!vars)
View(t)
View(t)
View(t)
xtable(t)
histogramas(microdados_enade, c('Norte', 'Nordeste', 'Sudeste', 'Sul', 'Centro-Oeste'),
c('CURSO_REGIAO', 'CURSO_REGIAO', 'CURSO_REGIAO',
'CURSO_REGIAO','CURSO_REGIAO'), c(1, 2, 3, 4, 5), main="Nota geral por região" )
histograma <- function(coluna_df, main='Histograma', xlab = "Nota", ylab= "Densidades", cex=1.0){
# Plota o histograma
hist(coluna_df, xlab = xlab, ylab= ylab, main = main, prob= TRUE, cex=cex)
# Calcula a distribuição normal com média e desvio padrão iguais aos dados plotados no histograma
points(seq(min(coluna_df), max(coluna_df)), dnorm(seq(min(coluna_df), max(coluna_df)), mean(coluna_df), sd(coluna_df)), type="l", col="red")
#ref: https://randyzwitch.com/overlay-histogram-in-r/
}
qq_plot <- function(df_coluna, main='Q-Q Plot', xlab= "Quantis teóricos", ylab="Quantis amostrais", cex = 1.0){
qqnorm(df_coluna, main=main, xlab=xlab, ylab=ylab, cex=cex)
qqline(df_coluna, col = 2,lwd=2,lty=2)
}
histogramas <- function(df, lista_rotulos, lista_var, lista_valores, main="Nota Geral da Prova (Enade)" ){
# remover mar = rep(2, 4) para aparecer os rótulos dos eixos. Adiciona cex=0.5 para rodar
par(mfrow=c(2,5), mar = rep(2, 4), oma = c(0, 0, 2, 0))
for (i in 1:length(lista_var)){
df_filtrado <- df %>% filter(!!as.symbol(lista_var[i]) == lista_valores[i])
histograma(df_filtrado$PROVA_NOTABRUTA, main = lista_rotulos[i], cex=1.5)
}
for (i in 1:length(lista_var)){
df_filtrado <- df %>% filter(!!as.symbol(lista_var[i]) == lista_valores[i])
qq_plot(df_filtrado$PROVA_NOTABRUTA, main = lista_rotulos[i], cex=1.5)
}
mtext(expression(bold('Nota geral por região')), outer = TRUE, cex = 1.5)
}
histogramas(microdados_enade, c('Norte', 'Nordeste', 'Sudeste', 'Sul', 'Centro-Oeste'),
c('CURSO_REGIAO', 'CURSO_REGIAO', 'CURSO_REGIAO',
'CURSO_REGIAO','CURSO_REGIAO'), c(1, 2, 3, 4, 5), main="Nota geral por região" )
histogramas <- function(df, lista_rotulos, lista_var, lista_valores, main="Nota Geral da Prova (Enade)" ){
# remover mar = rep(2, 4) para aparecer os rótulos dos eixos. Adiciona cex=0.5 para rodar
par(mfrow=c(2,5), cex=1, mar = rep(2, 4), oma = c(0, 0, 2, 0))
for (i in 1:length(lista_var)){
df_filtrado <- df %>% filter(!!as.symbol(lista_var[i]) == lista_valores[i])
histograma(df_filtrado$PROVA_NOTABRUTA, main = lista_rotulos[i], cex=1.5)
}
for (i in 1:length(lista_var)){
df_filtrado <- df %>% filter(!!as.symbol(lista_var[i]) == lista_valores[i])
qq_plot(df_filtrado$PROVA_NOTABRUTA, main = lista_rotulos[i], cex=1.5)
}
mtext(expression(bold('Nota geral por região')), outer = TRUE, cex = 1.5)
}
histogramas(microdados_enade, c('Norte', 'Nordeste', 'Sudeste', 'Sul', 'Centro-Oeste'),
c('CURSO_REGIAO', 'CURSO_REGIAO', 'CURSO_REGIAO',
'CURSO_REGIAO','CURSO_REGIAO'), c(1, 2, 3, 4, 5), main="Nota geral por região" )
histogramas(microdados_enade, c('Norte', 'Nordeste', 'Sudeste', 'Sul', 'Centro-Oeste'),
c('CURSO_REGIAO', 'CURSO_REGIAO', 'CURSO_REGIAO',
'CURSO_REGIAO','CURSO_REGIAO'), c(1, 2, 3, 4, 5), main="Nota geral por região" )
histogramas <- function(df, lista_rotulos, lista_var, lista_valores, main="Nota Geral da Prova (Enade)" ){
# remover mar = rep(2, 4) para aparecer os rótulos dos eixos. Adiciona cex=0.5 para rodar
par(mfrow=c(2,5), mar = rep(2, 4), oma = c(0, 0, 2, 0))
for (i in 1:length(lista_var)){
df_filtrado <- df %>% filter(!!as.symbol(lista_var[i]) == lista_valores[i])
histograma(df_filtrado$PROVA_NOTABRUTA, main = lista_rotulos[i], cex=1.5)
}
for (i in 1:length(lista_var)){
df_filtrado <- df %>% filter(!!as.symbol(lista_var[i]) == lista_valores[i])
qq_plot(df_filtrado$PROVA_NOTABRUTA, main = lista_rotulos[i], cex=1.5)
}
mtext(expression(bold('Nota geral por região')), outer = TRUE, cex = 1.5)
}
histogramas(microdados_enade, c('Norte', 'Nordeste', 'Sudeste', 'Sul', 'Centro-Oeste'),
c('CURSO_REGIAO', 'CURSO_REGIAO', 'CURSO_REGIAO',
'CURSO_REGIAO','CURSO_REGIAO'), c(1, 2, 3, 4, 5), main="Nota geral por região" )
histogramas(microdados_enade, c('Norte', 'Nordeste', 'Sudeste', 'Sul', 'Centro-Oeste'),
c('CURSO_REGIAO', 'CURSO_REGIAO', 'CURSO_REGIAO',
'CURSO_REGIAO','CURSO_REGIAO'), c(1, 2, 3, 4, 5), main="Nota geral por região" )
# histograma das notas por região
histogramas(microdados_enade, c('Norte', 'Nordeste', 'Sudeste', 'Sul', 'Centro-Oeste'),
c('CURSO_REGIAO', 'CURSO_REGIAO', 'CURSO_REGIAO',
'CURSO_REGIAO','CURSO_REGIAO'), c(1, 2, 3, 4, 5), main="Nota geral por região" )
